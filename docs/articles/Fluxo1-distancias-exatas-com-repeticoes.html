<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="distanceMonitoraflorestal">
<title>Ajuste-dos-modelos-fluxo1-distancias-exatas-com-repeticoes • distanceMonitoraflorestal</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Ajuste-dos-modelos-fluxo1-distancias-exatas-com-repeticoes">
<meta property="og:description" content="distanceMonitoraflorestal">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">distanceMonitoraflorestal</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/distanceMonitoraflorestal.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Carregando-uma-base-de-dados-atualizada.html">Carregando-uma-base-de-dados-atualizada</a>
    <a class="dropdown-item" href="../articles/Checagem-filtragem-e-transformacao-dos-dados.html">Checagem-filtragem-e-transformacao-dos-dados</a>
    <a class="dropdown-item" href="../articles/Exploracao-e-selecao-de-dados-para-analises.html">Exploracao-e-selecao-de-dados-para-analises</a>
    <a class="dropdown-item" href="../articles/Fluxo1-distancias-exatas-com-repeticoes.html">Ajuste-dos-modelos-fluxo1-distancias-exatas-com-repeticoes</a>
    <a class="dropdown-item" href="../articles/Fluxo2-distancias-exatas-sem-repeticoes.html">Ajuste-dos-modelos-fluxo2-distancias-exatas-sem-repeticoes</a>
    <a class="dropdown-item" href="../articles/Fluxo3-distancias-agrupadas-com-repeticoes.html">Ajuste-dos-modelos-fluxo3-distancias-agrupadas-com-repeticoes</a>
    <a class="dropdown-item" href="../articles/Fluxo4-multiplas-covariaveis.html">Ajuste-dos-modelos-fluxo4-amostragem-por-distancia-com-multiplas-covariaveis</a>
    <a class="dropdown-item" href="../articles/Fluxo5-estratificacao-por-unidade-de-conservacao.html">Ajuste-dos-modelos-fluxo5-amostragem-por-distancia-estratificada-por-unidade-de-conservacao</a>
    <a class="dropdown-item" href="../articles/Fluxo6-estratificacao-por-ano.html">Ajuste-dos-modelos-fluxo6-amostragem-por-distancia-estratificada-por-ano</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Ajuste-dos-modelos-fluxo1-distancias-exatas-com-repeticoes</h1>
            
      
      
      <div class="d-none name"><code>Fluxo1-distancias-exatas-com-repeticoes.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">distanceMonitoraflorestal</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="fluxo-de-análise-dos-dados">Fluxo de análise dos dados<a class="anchor" aria-label="anchor" href="#fluxo-de-an%C3%A1lise-dos-dados"></a>
</h2>
<p>A seguir, apresentamos o fluxo de análise dos dados que envolve a
fase exploratória, truncamento, ajuste e avaliação de modelos e
estimativas de abundância e densidade para as espécies que selecionamos
como modelo. Usamos como critérios de seleção tanto o número de
observações por Unidade de Conservação quanto a distribuição das
frequências de observação, nos casos em que isso foi possível. De forma
geral, as espécies com número satisfatório de observações ($&gt;$60),
apresentaram pico de observações próximos a zero.</p>
<p>Nós usamos como modelo para este fluxo os dados da cutia
<em>Dasyprocta croconota</em> coletados na Resex Tapajós-Arapiuns entre
2014 e 2021, pelo grande número de observações para uma mesma UC. Os
dados de distâncias perpendiculares para essa espécie apresentam três
características indesejadas: número excessivo de repetições amostrais
numa mesma estação amostral, pico de distâncias próximo a zero e
empilhamento de observações em uma mesma distância.</p>
<p>Para lidar com as repetições, testamos a análise dos dados com todas
as repetições e com o número de repetições reduzidas. Para lidar com os
picos de distância próximos a zero, testamos o uso dos dados com
distâncias exatas e distâncias agrupadas. Essas estratégias estão
descritas nos Fluxos 1-3. No primeiro fluxo, comentamos também as
escolhas feitas e os resultados obtidos. Os demais fluxos são repetições
deste primeiro fluxo, porém com mudança na estrutura dos dados.</p>
<p>Espécies com maior número de observações/UC possibilitam testar,
posteriormente, estratificações nos dados, preservando um número de
observações satisfatório dentro dos estratos. Por isso, começamos
apresentando um fluxo completo de análise, incluindo <strong>Amostragem
por Distância Convencional</strong>, <strong>Amostragem por Distância
com Múltiplas Covariáveis</strong> e <strong>Amostragem por Distância
com Estratificação</strong> nos dados com as espécies com maior número
de observações. Por isso, selecionamos como modelo a espécie com o maior
número de observações para uma mesma UC e a terceira com o maior número
total de observações.</p>
</div>
<div class="section level2">
<h2 id="espécie-modelo---dasyprocta-croconota---resex-tapajós-arapiuns">Espécie Modelo - <em>Dasyprocta croconota</em> - Resex Tapajós
Arapiuns<a class="anchor" aria-label="anchor" href="#esp%C3%A9cie-modelo---dasyprocta-croconota---resex-tapaj%C3%B3s-arapiuns"></a>
</h2>
<div class="float">
<img src="https://www.biolib.cz/IMG/GAL/BIG/205849.jpg" alt="Fonte: biolib.cz"><div class="figcaption">Fonte: biolib.cz</div>
</div>
<p>Essa é a espécie com o maior número de observações para uma mesma UC.
Apresentou, como a maioria das espécies em diferentes UCs, um pico de
observações próximo a dsitância zero. Também apresentou efeito de
empilhamento sobre as distâncias 5, 10, 15 e 20m, indicando que os dados
foram arrendondados para essas distâncias.</p>
<div class="section level3">
<h3 id="obter-os-dados-para-as-análises">Obter os dados para as análises<a class="anchor" aria-label="anchor" href="#obter-os-dados-para-as-an%C3%A1lises"></a>
</h3>
<p>É possível obter as observações da espécie e Unidade de Conservação
de interesse e torná-las analisáveis pelo pacote <code>Distance</code>
utilizando duas funções: <code><a href="../reference/filtrar_dados.html">filtrar_dados()</a></code> e
<code><a href="../reference/transformar_dados_formato_Distance.html">transformar_dados_formato_Distance()</a></code>. A primeira filtra a
base de dados original a partir da espécie e UC desejada eplos
argumentos <code>nome_sps</code> e <code>nome_ucs</code>, enquanto a
segunda transforma os dados para o formato do pacote
<code>Distance</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># carregar dados</span></span>
<span><span class="va">cutia_tap_arap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filtrar_dados.html">filtrar_dados</a></span><span class="op">(</span></span>
<span>  <span class="va">nome_ucs</span> <span class="op">==</span> <span class="st">"resex_tapajos_arapiuns"</span>,</span>
<span>  <span class="va">nome_sps</span> <span class="op">==</span> <span class="st">"dasyprocta_croconota"</span>,</span>
<span>  validacao_obs <span class="op">=</span> <span class="st">"especie"</span></span>
<span>  </span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/transformar_dados_formato_Distance.html">transformar_dados_formato_Distance</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cutia_tap_arap</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="amostragem-por-distância-convencional">Amostragem por Distância Convencional<a class="anchor" aria-label="anchor" href="#amostragem-por-dist%C3%A2ncia-convencional"></a>
</h3>
<div class="section level4">
<h4 id="fluxo-1---distâncias-exatas-com-todas-as-repetições">Fluxo 1 - Distâncias exatas com todas as repetições<a class="anchor" aria-label="anchor" href="#fluxo-1---dist%C3%A2ncias-exatas-com-todas-as-repeti%C3%A7%C3%B5es"></a>
</h4>
<div class="section level5">
<h5 id="plotando-o-histograma-das-frequências-de-observações-pela-distância">Plotando o histograma das frequências de observações pela
distância<a class="anchor" aria-label="anchor" href="#plotando-o-histograma-das-frequ%C3%AAncias-de-observa%C3%A7%C3%B5es-pela-dist%C3%A2ncia"></a>
</h5>
<p>O histograma interativo está disponível no aplicativo em Shiny
<code>app_distancia_interativo.R</code> em
<code>piper3d_monitora_florestal\apps</code>.</p>
<p>A distribuição dos dados no histograma permite observar um pico de
observações próximo a zero, assim como picos de observação em 5, 10, 15
e 20m, além de uma considerável perda em detectabilidade a partir dos
20m. É possível alterar a binagem dos histogramas através do argumento
<code>largura_caixa</code>. Neste exemplo ajustamos para 1, o que
facilita a observação de picos de detecação e efeitos de
<em>heaping</em> nos dados.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cutia_tap_arap</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="va">distance</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span><span class="fu"><a href="../reference/plotar_distribuicao_distancia_interativo.html">plotar_distribuicao_distancia_interativo</a></span><span class="op">(</span>largura_caixa <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Para eliminar as observações feitas a distâncias com baixa
detectabilidade, vamos testar diferentes proporções de truncamento.</p>
</div>
<div class="section level5">
<h5 id="testando-distância-de-truncamento-w">Testando distância de truncamento (<em>w</em>)<a class="anchor" aria-label="anchor" href="#testando-dist%C3%A2ncia-de-truncamento-w"></a>
</h5>
<p>Vamos explorar diferentes distâncias de truncamento para um mesmo
modelo de função chave com distribuição half-normal. Optamos por truncar
os dados pela percentagem para padronizar a rotina para diferentes
espécies. Buckland et al. (2001) sugere um corte entre 5-10% das
observações detectadas nas maiores distâncias. Vamos selecionar o valor
de corte pelo modelo com melhor ajuste utilizando a função
<code><a href="../reference/selecionar_distancia_truncamento.html">selecionar_distancia_truncamento()</a></code>. Para automatizar a
avaliação da truncagem para qualquer conjunto de dados, implementamos no
código o teste para as seguintes proporções de corte: 5, 10, 15, 20 e
25% das observações mais distantes. Contudo, os valores de corte podem
ser alterados pelo usuário fornecendo uma lista com novos valores ao
argumento <code>dist_truncamento</code>. A função gera uma tabela
comparando os modelos e também plotamos os gráficos dos modelos
ajustados para os dados truncados usando a função plotar_.</p>
<div class="section level6">
<h6 id="tabela-com-resumo-comparativo-dos-modelos">Tabela com resumo comparativo dos modelos<a class="anchor" aria-label="anchor" href="#tabela-com-resumo-comparativo-dos-modelos"></a>
</h6>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># conduz a selecao da melhor distancia de truncamento a partir do ajsute de modelos com funcao de deteccao half-normal sem termos de ajuste</span></span>
<span><span class="va">cutia_tap_arap_dist_trunc</span> <span class="op">&lt;-</span> <span class="va">cutia_tap_arap</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/selecionar_distancia_truncamento.html">selecionar_distancia_truncamento</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cutia_tap_arap_dist_trunc</span><span class="op">$</span><span class="va">selecao</span></span></code></pre></div>
<p>Os critérios de ajuste dos modelos servem aqui como uma informação
complementar, mas não serão decisivos na escolha da distância de
truncamento. Naturalmente, eliminando os dados das distãncias de menor
detectabilidade, os modelos tendem a ter um melhor ajuste pela menor
variabilidade dos dados. Além disso, nesse caso os valores de deltaAIC
serão sempre zero, pois não é possível comparar valores de AIC para
conjuntos de dados diferentes (nesse caso os dados diferem em número de
observações).</p>
</div>
<div class="section level6">
<h6 id="plotando-o-histograma-com-os-dados-truncados-">Plotando o histograma com os dados truncados.<a class="anchor" aria-label="anchor" href="#plotando-o-histograma-com-os-dados-truncados-"></a>
</h6>
<p>Histogramas resultantes dos modelos, com todas as distâncias de
truncagem, para auxiliar na seleção da melhor distãncia.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotar_funcao_deteccao_selecao_distancia_truncamento.html">plotar_funcao_deteccao_selecao_distancia_truncamento</a></span><span class="op">(</span><span class="va">cutia_tap_arap_dist_trunc</span><span class="op">)</span></span></code></pre></div>
<p>Após avaliar tanto o ajuste dos modelos quanto os gráficos, optamos
por truncar 10% das observações feitas nas maiores distâncias. Apesar
dos melhores valores de AIC e de ajuste do Cramér-von Mises para 25%, os
histogramas com modelos ajustados para 25%, 20% e 15% apresentaram
modelos quase lineares e com uma grande probabilidade de deteção nos
últimos intervalos de distância. O modelo com corte de 10% apresentou
uma curva decrescente e não tendeu a zero nas últimas distâncias. Já no
modelos para 5% as funções de deteção tendem a zero nos últimos
intervalos de distância. O corte de 10% das observações mais distantes
resultou em uma distância de truncamento de 15m.</p>
</div>
</div>
<div class="section level5">
<h5 id="ajustando-diferentes-modelos-de-funções-de-detecção">Ajustando diferentes modelos de funções de detecção<a class="anchor" aria-label="anchor" href="#ajustando-diferentes-modelos-de-fun%C3%A7%C3%B5es-de-detec%C3%A7%C3%A3o"></a>
</h5>
<p>As funções de detecção são ajustadas através da função
<code>ds()</code> no pacote Distence para o R. Para otimizar o fluxo de
ajuste de diferentes modelos de função de detecção, empacotamos as
diferentes combinações de funções chave (uniforme, half-normal e
hazard-rate) e termos de ajustes (cosseno, polinomial simples e
polinomial de Hermite) na função
<code>ajustar_modelos_distance()</code>.</p>
<p>Para definir a distância de truncamento dos dados é necessário
fornecer o argumento <code>truncamento</code>, que pode ser definido
tanto em percentagem de corte dos dados quanto em valor de
distãncia.</p>
<div class="section level6">
<h6 id="uniforme-com-termos-de-ajuste-cosseno-e-polinomial-simples">Uniforme com termos de ajuste Cosseno e polinomial simples<a class="anchor" aria-label="anchor" href="#uniforme-com-termos-de-ajuste-cosseno-e-polinomial-simples"></a>
</h6>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ajustando a função de detecção uniforme para um truncamento de 10% dos dados</span></span>
<span><span class="va">cutia_tap_arap_unif</span> <span class="op">&lt;-</span> <span class="va">cutia_tap_arap</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/ajustar_modelos_Distance.html">ajustar_modelos_Distance</a></span><span class="op">(</span></span>
<span>    funcao_chave <span class="op">=</span> <span class="st">"unif"</span>,</span>
<span>    truncamento <span class="op">=</span> <span class="st">"10%"</span><span class="op">)</span></span></code></pre></div>
<p>Dentre as combinações de termos de ajustes para a função chave de
distribuição uniforme, o Distance selecionou o modelo uniforme com
ajuste polinomial simples, com as ordens 2, 4 e 6. Ele mantém esse
modelo, e descarta os demais. Os <em>Warnings</em> indicando que a
função de detecção não é estritamente monotônica avisam que os dados não
foram constrangidos para a monotonicidade. Isso porque o uso de termos
de ajustes, especialmente de ordens acima de 2, podem levar à perda da
monotonidade (a curva pode se tornar crescente em algum momento, o que
não é desejado). É preciso avaliar se a falta desse constragimento levou
efetivamente à perda da monotonicidade ao olhar os gráficos de ajuste
dos modelos.</p>
</div>
<div class="section level6">
<h6 id="half-normal-sem-termos-de-ajuste-e-com-termos-de-ajuste-cosseno-e-polinomial-de-hermite">Half-Normal sem termos de ajuste e com termos de ajuste Cosseno e
Polinomial de Hermite<a class="anchor" aria-label="anchor" href="#half-normal-sem-termos-de-ajuste-e-com-termos-de-ajuste-cosseno-e-polinomial-de-hermite"></a>
</h6>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ajustando a função de detecção half-normal para um truncamento de 10% dos dados</span></span>
<span><span class="va">cutia_tap_arap_hn</span> <span class="op">&lt;-</span> <span class="va">cutia_tap_arap</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/ajustar_modelos_Distance.html">ajustar_modelos_Distance</a></span><span class="op">(</span></span>
<span>    funcao_chave <span class="op">=</span> <span class="st">"hn"</span>,</span>
<span>    truncamento <span class="op">=</span> <span class="st">"10%"</span><span class="op">)</span></span></code></pre></div>
<p>Neste caso, o modelo selecionado pelo Distance foi o Half-normal sem
nenhum termo de ajuste.</p>
</div>
<div class="section level6">
<h6 id="hazard-rate-sem-termos-de-ajuste-e-com-termos-de-ajuste-cosseno-e-polinomial-de-hermite">Hazard-rate sem termos de ajuste e com termos de ajuste Cosseno e
Polinomial de Hermite<a class="anchor" aria-label="anchor" href="#hazard-rate-sem-termos-de-ajuste-e-com-termos-de-ajuste-cosseno-e-polinomial-de-hermite"></a>
</h6>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ajustando a função de detecção hazard-rate para um truncamento de 10% dos dados</span></span>
<span><span class="va">cutia_tap_arap_hr</span> <span class="op">&lt;-</span> <span class="va">cutia_tap_arap</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/ajustar_modelos_Distance.html">ajustar_modelos_Distance</a></span><span class="op">(</span></span>
<span>    funcao_chave <span class="op">=</span> <span class="st">"hr"</span>,</span>
<span>    truncamento <span class="op">=</span> <span class="st">"10%"</span><span class="op">)</span></span></code></pre></div>
<p>Aqui o melhor modelo selecionado pelo <code>Distance</code> foi o
Hazard-rate sem os termos de ajuste. Nesse caso, também há um
<em>warning</em> para o problema na distribuição dos dados, que
apresentam um pico próximo a distância zero e não são bem ajustados pelo
modelo hazard-hate.</p>
</div>
</div>
<div class="section level5">
<h5 id="comparando-os-modelos">Comparando os modelos<a class="anchor" aria-label="anchor" href="#comparando-os-modelos"></a>
</h5>
<p>Para comparar os modelos é preciso avaliar três critérios: AIC,
ajuste e forma das funções nos gráficos e bondade de ajuste. O pacote
<code>Distance</code> possui a função <code>summarize_ds_models</code>
que gera uma tabela com os modelos para comparação de alguns parâmetros:
a primeira coluna <strong>Model</strong>, indica as funções chaves e
respectivos termos de ajuste; a coluna <strong>Formula</strong>
apresenta as covariáveis, quando incluídas no modelo, ou ~ 1, quando não
há covariáveis; <strong>C-vM p-value</strong> vai apresentar os valores
de p para o teste de bondade de ajuste de Cramér-von Mises; <span class="math inline">\(\hat{P_a}\)</span> apresenta a probalidade de
deteção global estimada para cada modelo; <strong>se</strong>(<span class="math inline">\(\hat{P_a}\)</span>) apresenta o erro padrão para
as estimativas de probabilidade de detecção; e <span class="math inline">\(\Delta\)</span>AIC apresenta os valores de
diferença entre os AIC’s de modelos subsequentes.</p>
<div class="section level6">
<h6 id="tabela-com-o-resumo-comparativo-dos-modelos">Tabela com o resumo comparativo dos modelos<a class="anchor" aria-label="anchor" href="#tabela-com-o-resumo-comparativo-dos-modelos"></a>
</h6>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fluxo1_selecao_funcao_deteccao_termo_ajuste</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/selecionar_funcao_deteccao_termo_ajuste.html">selecionar_funcao_deteccao_termo_ajuste</a></span><span class="op">(</span></span>
<span>  <span class="va">cutia_tap_arap_hn</span><span class="op">$</span><span class="va">`Sem termo`</span>,</span>
<span>  <span class="va">cutia_tap_arap_hn</span><span class="op">$</span><span class="va">Cosseno</span>,</span>
<span>  <span class="va">cutia_tap_arap_hn</span><span class="op">$</span><span class="va">`Hermite polinomial`</span>,</span>
<span>  <span class="va">cutia_tap_arap_hr</span><span class="op">$</span><span class="va">`Sem termo`</span>,</span>
<span>  <span class="va">cutia_tap_arap_hr</span><span class="op">$</span><span class="va">Cosseno</span>,</span>
<span>  <span class="va">cutia_tap_arap_hr</span><span class="op">$</span><span class="va">`Polinomial simples`</span>,</span>
<span>  <span class="va">cutia_tap_arap_unif</span><span class="op">$</span><span class="va">Cosseno</span>,</span>
<span>  <span class="va">cutia_tap_arap_unif</span><span class="op">$</span><span class="va">`Polinomial simples`</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fluxo1_selecao_funcao_deteccao_termo_ajuste</span></span></code></pre></div>
<p>Dentre os modelos testados, o que apresentou melhor valor de ajuste e
AIC foi o hazard-rate. O ajuste do Cramér-von Mises foi
consideravelmente maior que os demais (para esse tipo de teste, quanto
maior o valor de p, melhor o ajuste), assim como as diferenças no delta
AIC foram bastante elevadas.</p>
</div>
<div class="section level6">
<h6 id="gráficos-de-ajuste-das-funções-de-deteção-às-probabilidades-de-deteção">Gráficos de ajuste das funções de deteção às probabilidades de
deteção<a class="anchor" aria-label="anchor" href="#gr%C3%A1ficos-de-ajuste-das-fun%C3%A7%C3%B5es-de-dete%C3%A7%C3%A3o-%C3%A0s-probabilidades-de-dete%C3%A7%C3%A3o"></a>
</h6>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># gerar uma lista com os modelos selecionados ordenados do melhor para o pior modelo</span></span>
<span><span class="va">fluxo1_modelos_selecionados</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gerar_lista_modelos_selecionados.html">gerar_lista_modelos_selecionados</a></span><span class="op">(</span></span>
<span>  <span class="va">cutia_tap_arap_hr</span><span class="op">$</span><span class="va">`Sem termo`</span>,</span>
<span>  <span class="va">cutia_tap_arap_unif</span><span class="op">$</span><span class="va">`Cosseno`</span>,</span>
<span>  <span class="va">cutia_tap_arap_hn</span><span class="op">$</span><span class="va">`Cosseno`</span>,</span>
<span>  <span class="va">cutia_tap_arap_unif</span><span class="op">$</span><span class="va">`Polinomial simples`</span>,</span>
<span>  <span class="va">cutia_tap_arap_hn</span><span class="op">$</span><span class="va">`Sem termo`</span>, </span>
<span>  nome_modelos_selecionados <span class="op">=</span> <span class="va">fluxo1_selecao_funcao_deteccao_termo_ajuste</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plotar a probabilidade de detecção observada (barras) e a esperada (linhas e pontos)</span></span>
<span><span class="fu"><a href="../reference/plotar_funcao_deteccao_modelos_selecionados.html">plotar_funcao_deteccao_modelos_selecionados</a></span><span class="op">(</span><span class="va">fluxo1_modelos_selecionados</span><span class="op">)</span></span></code></pre></div>
<p>Olhando para os histogramas com modelos ajustados, é possível
observar o efeito do acúmulo de observações próximo a zero. O modelo com
a função chave hazard-hate sem termos de ajuste, apesar de ter
apresentado o melhor valor de ajuste pelo Cramér-von Mises e o melhor
valor de AIC, apresentou dois problemas. As probalidades de deteção
estimadas por intevalo de distância (barras verdes), ficaram muito
baixas. Além disso, a curva da função de deteção apresenta pico na
distância próxima a zero, decaindo rapidamente e se aproximando de zero
ao longo do eixo das distãncias. Todos os outros quatro modelos tiveram
ajuste e AIC bastante inferiores ao hazard-hate. Entretanto as curvas
estão relativamente melhores. As curvas do segundo e terceiro modelo,
uniforme com ajuste cosseno e half-normal com ajuste cosseno,
respectivamente, tendem à perda de monotonicidade. As duas últimas
curvas, para os modelos uniforme com ajuste polinomial simples e
half-normal sem ajuste, não perdem a monotonicidade. De forma geral, as
probabilidades de detecção não têm um bom ajuste abaixo da curva, e não
apresentam um decaimento gradual com a distância. Esses são problemas
inerentes à distribuição dos dados.</p>
</div>
<div class="section level6">
<h6 id="teste-de-bondade-de-ajuste-dos-modelos-e-q-q-plots">Teste de bondade de ajuste dos modelos e Q-Q plots<a class="anchor" aria-label="anchor" href="#teste-de-bondade-de-ajuste-dos-modelos-e-q-q-plots"></a>
</h6>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bondade_ajuste_fluxo1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/testar_bondade_ajuste.html">testar_bondade_ajuste</a></span><span class="op">(</span></span>
<span>  <span class="va">fluxo1_modelos_selecionados</span>, </span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  chisq <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>  intervalos_distancia  <span class="op">=</span>  <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">bondade_ajuste_fluxo1</span></span></code></pre></div>
<p>Aqui são gerados Q-Q plots que permitem avaliar a qualidade do ajuste
dos modelos. E também uma tabela com os resultados do Carmér-von Mises,
onde W é o valor do teste e p seu valor de significância. Nesse caso,
quanto maior o valor de p, melhor o ajuste do modelo.</p>
</div>
</div>
<div class="section level5">
<h5 id="avaliando-as-estimativas-de-abundância-e-densidade">Avaliando as estimativas de Abundância e Densidade<a class="anchor" aria-label="anchor" href="#avaliando-as-estimativas-de-abund%C3%A2ncia-e-densidade"></a>
</h5>
<p>Aqui, são resumidos os dados de taxa de encontro, abundância e
densidade em três tabelas.</p>
<div class="section level6">
<h6 id="características-da-área-de-estudo-e-da-taxa-de-encontro">Características da área de estudo e da taxa de encontro<a class="anchor" aria-label="anchor" href="#caracter%C3%ADsticas-da-%C3%A1rea-de-estudo-e-da-taxa-de-encontro"></a>
</h6>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># gera resultados área de estudo e taxa de encontro</span></span>
<span><span class="va">fluxo1_caracteristicas_area_estudo_taxa_encontro</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gerar_resultados_Distance.html">gerar_resultados_Distance</a></span><span class="op">(</span></span>
<span>  dados <span class="op">=</span> <span class="va">fluxo1_modelos_selecionados</span>,</span>
<span>  resultado_selecao_modelos <span class="op">=</span> <span class="va">fluxo1_selecao_funcao_deteccao_termo_ajuste</span>,</span>
<span>  tipo_de_resultado <span class="op">=</span> <span class="st">"area_estudo"</span>, </span>
<span>  estratificacao <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fluxo1_caracteristicas_area_estudo_taxa_encontro</span></span></code></pre></div>
</div>
<div class="section level6">
<h6 id="características-de-abundância-esforço-e-detecção">Características de abundância, esforço e detecção<a class="anchor" aria-label="anchor" href="#caracter%C3%ADsticas-de-abund%C3%A2ncia-esfor%C3%A7o-e-detec%C3%A7%C3%A3o"></a>
</h6>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># gerar resultados abundância e detecção</span></span>
<span><span class="va">fluxo1_caracteristicas_esforco_abundancia_deteccao</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gerar_resultados_Distance.html">gerar_resultados_Distance</a></span><span class="op">(</span></span>
<span>  dados <span class="op">=</span> <span class="va">fluxo1_modelos_selecionados</span>,</span>
<span>  resultado_selecao_modelos <span class="op">=</span> <span class="va">fluxo1_selecao_funcao_deteccao_termo_ajuste</span>,</span>
<span>  tipo_de_resultado <span class="op">=</span> <span class="st">"abundancia"</span>, </span>
<span>  estratificacao <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fluxo1_caracteristicas_esforco_abundancia_deteccao</span></span></code></pre></div>
</div>
<div class="section level6">
<h6 id="características-de-densidade">Características de densidade<a class="anchor" aria-label="anchor" href="#caracter%C3%ADsticas-de-densidade"></a>
</h6>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># gerar resultados densidade e coeficiente de variação</span></span>
<span><span class="va">fluxo1_caracteristicas_densidade</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gerar_resultados_Distance.html">gerar_resultados_Distance</a></span><span class="op">(</span></span>
<span>  dados <span class="op">=</span> <span class="va">fluxo1_modelos_selecionados</span>,</span>
<span>  resultado_selecao_modelos <span class="op">=</span> <span class="va">fluxo1_selecao_funcao_deteccao_termo_ajuste</span>,</span>
<span>  tipo_de_resultado <span class="op">=</span> <span class="st">"densidade"</span>, </span>
<span>  estratificacao <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fluxo1_caracteristicas_densidade</span></span></code></pre></div>
</div>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by .</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
